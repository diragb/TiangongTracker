!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i(require("AstroLib")):"function"==typeof define&&define.amd?define("OrbitDisplays",["AstroLib"],i):"object"==typeof exports?exports.OrbitDisplays=i(require("AstroLib")):t.OrbitDisplays=i(t.AstroLib)}("undefined"!=typeof self?self:this,function(t){return function(t){var i={};function e(s){if(i[s])return i[s].exports;var o=i[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=i,e.d=function(t,i,s){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:s})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="F:\\projects_git\\orbit-displays\\dist",e(e.s=2)}([function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s,o,a=e(1);(o=s||(s={}))[o.Geographic=0]="Geographic",o[o.Parallel=1]="Parallel";var h=function(){function t(){this.rotationAboutLOS=0,this.x0=0,this.y0=0,this.earthRadius=6371,this.earthWidth=12742}return t.drawCurve=function(i,e,s,o,a,h){if(h=h||!1,i.beginPath(),t.drawLines(i,t.getCurvePoints(e,s,o,a)),h){i.stroke(),i.beginPath();for(var n=0;n<e.length-1;n+=2)i.rect(e[n]-2,e[n+1]-2,4,4)}},t.drawLines=function(t,i){t.moveTo(i[0],i[1]);for(var e=2;e<i.length-1;e+=2)t.lineTo(i[e],i[e+1])},t.getCurvePoints=function(t,i,e,s){i=void 0!==i?i:.5,e=e||!1,s=s||16;var o,a,h,n,r,c,l,x,u,f,g,d,p,v=[],w=[];for(v=t.slice(0),e?(v.unshift(t[t.length-1]),v.unshift(t[t.length-2]),v.unshift(t[t.length-1]),v.unshift(t[t.length-2]),v.push(t[0]),v.push(t[1])):(v.unshift(t[1]),v.unshift(t[0]),v.push(t[t.length-2]),v.push(t[t.length-1])),p=2;p<v.length-4;p+=2)for(d=0;d<=s;d++)h=(v[p+2]-v[p-2])*i,n=(v[p+4]-v[p])*i,r=(v[p+3]-v[p-1])*i,c=(v[p+5]-v[p+1])*i,g=d/s,l=2*Math.pow(g,3)-3*Math.pow(g,2)+1,x=-2*Math.pow(g,3)+3*Math.pow(g,2),u=Math.pow(g,3)-2*Math.pow(g,2)+g,f=Math.pow(g,3)-Math.pow(g,2),o=l*v[p]+x*v[p+2]+u*h+f*n,a=l*v[p+1]+x*v[p+3]+u*r+f*c,w.push(o),w.push(a);return w},t.drawArrow=function(t,i,e,s,o,h,n){t.moveTo(i,e);var r=a.Matrix.fromRotationAboutAxis(2,s*a.DEGTORAD),c=o*a.DEGTORAD,l=h*a.DEGTORAD,x=-n*Math.cos(c),u=n*Math.sin(c),f=r.multiplyVector(new a.Vector(x,u,0));t.lineTo(i+f.x,e+f.y);var g=x;90!=h&&(g=x+u/Math.tan(l)),f=r.multiplyVector(new a.Vector(g,0,0)),t.lineTo(i+f.x,e+f.y),f=r.multiplyVector(new a.Vector(x,-u,0)),t.lineTo(i+f.x,e+f.y),t.lineTo(i,e)},t}();i.DrawingHelpers=h},function(i,e){i.exports=t},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e(0);i.DrawingHelpers=s.DrawingHelpers;var o=e(3);i.GroundTrackDisplay=o.GroundTrackDisplay},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e(1),o=e(0),a=function(){function t(t){this.showSun=!0,this.showEquator=!0,this.showDayShading=!0,this.showSAA=!1,this.minElev=5,this.time=t.time,this.canvas=t.canvas,this.earthImage=t.earthImage,this.primarySatellite=t.primarySatellite,this.secondarySatellites=t.secondarySatellites,this.stations=t.groundStations,this.showSun=t.showSun,this.showEquator=t.showEquator,this.showDayShading=t.showDayShading,this.showSAA=t.showSAA,this.saaText=t.saaText,this.font=t.font,this.ctx=this.canvas.getContext("2d")}return t.prototype.render=function(){var i=this,e=(s.Earth.gha(this.time),this.canvas.width),a=this.canvas.height;if(a>e/2&&(this.ctx.rect(0,(a-e/2)/2,e,e/2),this.ctx.clip()),this.ctx.font=this.font,this.earthImage){var h=this.earthImage.width*a/e,n=(this.earthImage.height-h)/2;this.ctx.drawImage(this.earthImage,0,n,this.earthImage.width,h,0,0,e,a)}var r=s.Sun.getRoughPos(this.time).rotateAboutZAxis(-s.Earth.gha(this.time));if(this.showDayShading&&(this.ctx.beginPath(),this.addCircularZonePath(r.scale(-1),s.HALFPI),this.ctx.fillStyle="#000000",this.ctx.globalAlpha=.5,this.ctx.fill(),this.ctx.globalAlpha=1),this.showSAA){this.ctx.fillStyle="#00ff00",this.ctx.strokeStyle="green",this.ctx.beginPath();for(var c=[],l=0;l<t.sSAAData.length/2;l++)c.push(t.sSAAData[2*l]*e/360),c.push(t.sSAAData[2*l+1]*e/360+(a-e/2)/2);if(o.DrawingHelpers.drawCurve(this.ctx,c,.5,!0,4,!1),this.ctx.globalAlpha=.1,this.ctx.fill(),this.ctx.globalAlpha=1,this.ctx.stroke(),this.saaText){var x=this.vectorToCanvas(s.Vector.fromAzElev(t.sSAACenter[1]*s.DEGTORAD,t.sSAACenter[0]*s.DEGTORAD));this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillStyle="white",this.ctx.fillText(this.saaText,x[0],x[1])}}if(this.showEquator){this.ctx.strokeStyle="gray",this.ctx.beginPath();var u=.5*this.canvas.height;this.ctx.moveTo(0,u),this.ctx.lineTo(this.canvas.width,u),this.ctx.stroke()}if(this.stations&&this.stations.length>0){var f=new s.Sgp4Orbit(this.primarySatellite.tle),g=(f.getLatLng(this.time),f.getHeight(this.time)),d=this.minElev*s.DEGTORAD,p=s.HALFPI-d-Math.asin(s.Earth.RADIUS*Math.cos(d)/(s.Earth.RADIUS+g));this.ctx.textAlign="center",this.ctx.textBaseline="top",this.stations.forEach(function(t){i.ctx.beginPath();var e=s.Vector.fromAzElev(t.longitude*s.DEGTORAD,t.latitude*s.DEGTORAD);i.addCircularZonePath(e,p),i.ctx.strokeStyle=t.zoneBorderColor,i.ctx.fillStyle=t.zoneColor,i.ctx.globalAlpha=.3,i.ctx.fill(),i.ctx.globalAlpha=1,i.ctx.stroke();var o=i.vectorToCanvas(e),a=[0,0];if(t.icon){var h=o[0]-t.icon.width/2,n=o[1]-t.icon.height/2;a=[0,t.icon.height/2],t.iconOffset&&(h+=t.iconOffset[0],n+=t.iconOffset[1],a[1]+=t.iconOffset[1]),i.ctx.drawImage(t.icon,h,n)}i.ctx.fillStyle="white",i.ctx.fillText(t.name,o[0]+a[0],o[1]+a[1])})}if(this.secondarySatellites.forEach(function(t){i.drawSatelliteTrack(t)}),this.drawSatelliteTrack(this.primarySatellite),this.showSun){var v=this.geodeticToCanvas(r.latitude*s.RADTODEG,r.longitude*s.RADTODEG);this.ctx.beginPath();this.drawStar(this.ctx,v[0],v[1],6,12,8),this.ctx.strokeStyle="red",this.ctx.fillStyle="orange",this.ctx.stroke(),this.ctx.fill(),this.ctx.beginPath(),this.ctx.arc(v[0],v[1],6,0,s.TWOPI),this.ctx.fillStyle="yellow",this.ctx.stroke(),this.ctx.fill()}this.secondarySatellites.forEach(function(t){i.drawSatellite(t)}),this.drawSatellite(this.primarySatellite)},t.prototype.drawStar=function(t,i,e,o,a,h){t.beginPath();var n=s.TWOPI/h;t.moveTo(i,e-a);for(var r=0;r<h;r++){var c=(r+.5)*n;t.lineTo(i+o*Math.sin(c),e-o*Math.cos(c)),c=(r+1)*n,t.lineTo(i+a*Math.sin(c),e-a*Math.cos(c))}t.lineTo(i,e-a)},t.prototype.vectorToCanvas=function(t){var i=t.latitude*s.RADTODEG,e=t.longitude*s.RADTODEG;return e<-180&&(e+=360),e>180&&(e-=360),this.geodeticToCanvas(i,e)},t.prototype.geodeticToCanvas=function(t,i){var e=this.canvas.width/360;return[(180+i)*e,.5*this.canvas.height-t*e]},t.prototype.addCircularZonePath=function(t,i){for(var e,o=new s.GroundStation(t.latitude,t.longitude,0).geographicToTopocentricMatrix().transpose(),a=Math.cos(i),h=Math.sin(i),n=this.canvas.width,r=0;r<=360;r+=1){var c=r*s.DEGTORAD,l=new s.Vector(h*Math.sin(c),h*Math.cos(c),a),x=o.multiplyVector(l),u=this.vectorToCanvas(x);e?this.addLineToPath(e,u):this.ctx.moveTo(u[0],u[1]),e=u}t.angleBetween(new s.Vector(0,0,1))<i&&this.ctx.rect(-1,-1,n+2,this.canvas.height+2)},t.prototype.addLineToPath=function(t,i){var e=this.canvas.width,s=this.canvas.height;Math.abs(i[0]-t[0])>.5*e?i[0]<t[0]?(this.ctx.lineTo(i[0]+e,i[1]),this.ctx.lineTo(e+5,i[1]),this.ctx.lineTo(e+5,s+5),this.ctx.lineTo(-5,s+5),this.ctx.lineTo(-5,t[1]),this.ctx.lineTo(t[0]-e,t[1]),this.ctx.lineTo(i[0],i[1])):(this.ctx.lineTo(i[0]-e,i[1]),this.ctx.lineTo(-5,i[1]),this.ctx.lineTo(-5,s+5),this.ctx.lineTo(e+5,s+5),this.ctx.lineTo(e+5,t[1]),this.ctx.lineTo(t[0]+e,t[1]),this.ctx.lineTo(i[0],i[1])):this.ctx.lineTo(i[0],i[1])},t.prototype.drawSatellite=function(t){if(t.tle){var i=new s.Sgp4Orbit(t.tle).getLatLng(this.time),e=this.geodeticToCanvas(i[0],i[1]);t.icon?this.ctx.drawImage(t.icon,e[0]-t.icon.width/2,e[1]-t.icon.height/2):(this.ctx.strokeStyle="white",this.ctx.fillStyle="red",this.ctx.beginPath(),this.ctx.arc(e[0],e[1],5,0,2*Math.PI,!0),this.ctx.fill(),this.ctx.stroke()),t.text&&(this.ctx.fillStyle="white",this.ctx.textAlign="left",this.ctx.textBaseline="top",this.ctx.fillText(t.text,e[0]+t.icon.width/2,e[1]+t.icon.height/2))}},t.prototype.drawSatelliteTrack=function(t){if(t.tle){var i,e,o=new s.Sgp4Orbit(t.tle);this.ctx.strokeStyle=t.orbitColor;this.canvas.width;var a=!1,h=o.period,n=h/100,r=this.time-t.orbitsToShow*h/2,c=this.time+t.orbitsToShow*h/2,l=o.isSunlit(r);l?this.ctx.setLineDash([]):this.ctx.setLineDash([5,10]);for(this.ctx.beginPath();r<=c;){o.getLatLng(r);var x=o.isSunlit(r),u=this.getOrbitPoint(o,r),f=u[0],g=u[1];if(a)if(x!=l){var d=o.findNextSunRiseSet(r-n,10*n);if(NaN!=d){var p=(u=this.getOrbitPoint(o,d))[0],v=u[1];this.addLineToPath([i,e],u),this.ctx.stroke();var w=Math.atan2(v-e,p-i)+s.HALFPI,T=p-10*Math.cos(w),S=v-10*Math.sin(w);this.ctx.setLineDash([]),this.ctx.beginPath(),this.ctx.moveTo(T,S),T=p+10*Math.cos(w),S=v+10*Math.sin(w),this.ctx.lineTo(T,S),this.ctx.stroke(),x?this.ctx.setLineDash([]):this.ctx.setLineDash([5,10]),this.ctx.beginPath(),this.ctx.moveTo(p,v),this.addLineToPath([p,v],[f,g])}}else this.addLineToPath([i,e],[f,g]);else this.ctx.moveTo(f,g);i=f,e=g,l=x,r+=n,a=!0}this.ctx.stroke(),this.ctx.setLineDash([0]),t.orbitsToShow>0&&(this.ctx.fillStyle=t.orbitColor,this.drawDirectionArrow(this.time-t.orbitsToShow*h/4,o),this.ctx.fill(),this.ctx.stroke(),this.drawDirectionArrow(this.time+t.orbitsToShow*h/4,o),this.ctx.fill(),this.ctx.stroke())}},t.prototype.getOrbitPoint=function(t,i){var e=t.getLatLng(i);return this.geodeticToCanvas(e[0],e[1])},t.prototype.drawDirectionArrow=function(t,i){var e=i.getLatLng(t),a=this.geodeticToCanvas(e[0],e[1]);e=i.getLatLng(t+5e3);var h=this.geodeticToCanvas(e[0],e[1]),n=Math.atan2(h[1]-a[1],h[0]-a[0])*s.RADTODEG;this.ctx.beginPath(),o.DrawingHelpers.drawArrow(this.ctx,a[0],a[1],n,15,90,15)},t.sSAAData=[105.27731,115.05203,108,111.26774,113.44538,107.02933,121.76471,102.94229,131.14285,99.30936,140.67227,98.24976,151.41176,99.158,157.76471,101.42857,163.5126,104.91013,164.11765,107.63482,163.21008,111.26774,159.27731,114.74929,153.07564,119.13908,143.09244,123.07474,131.59663,127.16178,124.33614,127.91864,115.56303,127.31315,109.5126,125.34531,105.73109,121.71239],t.sSAACenter=[-23,-45],t}();i.GroundTrackDisplay=a;var h=function(){return function(){}}();i.GroundTrackDisplayDef=h;var n=function(){return function(){}}();i.DisplaySatellite=n;var r=function(){return function(){}}();i.DisplayStation=r}])});